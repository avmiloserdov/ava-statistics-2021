# ava-statistics-2

Ветка dev содержит скрипты на языке R, выполняющие различные виды анализа данных и обеспечивающих дополнительный функционал на сайте

## 1. PCA - метод главных компонент

Применение метода главных компонент позволяет уменьшить размерность данных из ENV таблиц, при этом потеряв минимальное количество информации.

Запуска скрипта производится с помощью консольной команды:

    Rscript <название исполняемого скрипта> <имя файла> <номер листа в книге excel> <кол-во анализирумых столбцов> <название столбца 1> .. <название столбца n)
    Пример запуска скрипта:
    Rscript PCA_1.R new_yava_Bovan_ksermokhina_2005_env_fortv_full_header.xlsx 1 6 COV_SHRUBS COV_MOSS COV_LICH COV_TOTAL SHRUB_HT HERB_HT


Первый этап исполнения скрипта - чтение данных из консоли

```
args <- commandArgs()
print(args)
n <- as.numeric(args[7])
data <- read_excel(args[6], sheet = n)
```


Формируется вектор переменных, обращение к конкетретной переменной происходит по индексу. Первые 5 переменных являются системными и не используются при анализе

Далее осуществляется подготовка данных к анализу - названия строк заменяются на значения из столбца FIELD_NR:

`data <- column_to_rownames(data, var = colnames(data[2]))`

Третий этап - непосредственный запуск анализа PCA с определенными параметрами:

`data.pca <- prcomp(na.omit(data),scale=TRUE)`

Подробная [документация](https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/prcomp) метода prcomp 
Параметр na.omit обрабатывает пустые значения, а параметр scale = True отвечает за масштабирование выводимых результатов

Затем с помощью методов print и biplot происходит вывод результатов анализа, при запуске скрипта через консоль автоматически генерируется PDF-файл с названием Rplot

```
print(data.pca)
biplot(data.pca,scale=TRUE,xlim=c(-0.5,0.5))
```


Скрипт коррекно работает с численными данными, анализ других типов данных не предусмотрен

2. Factor_Test - факторный анализ

Ветка dev также содержит скрипты, обеспечивающие работу дополнительного функционала на сайте:

1. Classify_by_groups осуществляет подсчет количества видов растений, относящихся к тому или иному отделу 
(мхи, сосудистые, лишайники, печеночники) и выводит результаты в консоль
2. charts_for_groups - скрипт осуществляет построение графика: на оси X названия датасетов,
на оси Y - количество растенений выбранной группы в датасете
